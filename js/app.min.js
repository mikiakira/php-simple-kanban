
$(function(){$("#card_label_color,#board_color,#board_new_color").spectrum({preferredFormat:"hex",showInput:true,showInitial:true,showPaletteOnly:true,palette:[["#ffffff","#cccccc","#999999","#666666","#333333","#000000"],["#f44336","#ff9800","#ffeb3b","#8bc34a","#4caf50","#03a9f4","#2196f3"]]});$(".sortable").sortable();$(document).on("sortstop",".sortable",function(){var b=[];$(".pannel").each(function(d){var c=$(this).find("h2").attr("data-id");if(c!==""){b.push(c)}});var a=JSON.stringify(b);exePost("panels","sort","",a,"").done(function(){}).fail(function(){alert("system Error")})});$(".panel-body").sortable({connectWith:".panel-body"});$(document).on("sortstop",".panel-body",function(){$(".pannel").each(function(c){var b=$(this).find("h2").attr("data-id");if(b!==""){var d=[];$("#panel_area .panel h2[data-id='"+b+"']").parent().parent().children(".panel-body").find(".card").each(function(f){var e=$(this).attr("cardid");if(e!==""){d.push(e)}});var a=JSON.stringify(d);exePost("cards","sort",b,a,"").done(function(){}).fail(function(){alert("system Error")})}})});exePost("boards","first","","","").done(function(b){if(b){var a=$.parseJSON(b);$("#board_title h1").html(a.title);$("#board_title").attr("data-id",a.id);$("body").css("background-color",a.board_color);$("input#board_title_text").val(a.title);$("input#board_color").val(a.board_color);$("input#board_color").spectrum({showSelectionPalette:true,preferredFormat:"hex",showInput:true,showInitial:true,showPaletteOnly:true,palette:[["#ffffff","#cccccc","#999999","#666666","#333333","#000000"],["#f44336","#ff9800","#ffeb3b","#8bc34a","#4caf50","#03a9f4","#2196f3"]]});getPanels(a.id)}}).fail(function(a){alert("system Error")});getBoardList();$(document).on("click","#board_all_list li",function(){var a=$(this).attr("data-board");getBoard(a);$("#board_all_list").toggle("display")});$(document).on("click","#board_list",function(){$("#board_all_list").toggle("display")})});function getBoardList(){$("#board_all_list").html("");exePost("boards","list","","","").done(function(b){var c=$.parseJSON(b);var a="";$.each(c,function(d,e){a+="<li class='list-group-item' data-board='"+e.id+"' style='background: 10px "+e.board_color+"'>"+e.title+"</li>"});$("#board_all_list").html(a);$("#board_all_list").hide()}).fail(function(a){alert("system Error")})}function getPanels(a){exePost("panels","list",a,"","").done(function(c){if(c!==false){var d=$.parseJSON(c);var b="";$.each(d,function(e,f){$("#panel_area").append($("#hidden .panel").html());$("#panel_area .panel:last-child h2").html(f.title);$("#panel_area .panel:last-child h2").attr("data-id",f.id);exePost("cards","list",f.id,"","").done(function(g){var h=$.parseJSON(g);var i="";$.each(h,function(j,k){i+="<div class='card panel panel-default' style='border-top: 12px solid "+k.label_color+"' label_color='"+k.label_color+"' cardId='"+k.id+"'>"+k.title+"</div>"});$("#panel_area .panel h2[data-id='"+f.id+"']").parent().parent().children(".panel-body").append(i);$("#panel_area .panel h2[data-id='"+f.id+"']").parent().parent().children(".panel-body").sortable({connectWith:".panel-body"})})})}}).fail(function(b){alert("system Error")})}function getBoard(a){exePost("boards","find",a,"","").done(function(c){var b=$.parseJSON(c);$("#board_title h1").html(b.title);$("#board_title").attr("data-id",b.id);$("body").css("background-color",b.board_color);$("input#board_title_text").val(b.title);$("input#board_color").val(b.board_color);$("input#board_color").spectrum({showSelectionPalette:true,preferredFormat:"hex",showInput:true,showInitial:true,showPaletteOnly:true,palette:[["#ffffff","#cccccc","#999999","#666666","#333333","#000000"],["#f44336","#ff9800","#ffeb3b","#8bc34a","#4caf50","#03a9f4","#2196f3"]]});$("#panel_area").html("");getPanels(b.id)}).fail(function(b){alert("system Error")})};